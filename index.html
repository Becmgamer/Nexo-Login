<!DOCTYPE html>
<html>
<head>
  <title>Nexus Studios - Login</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body{
      background: linear-gradient(135deg, #00ffcc, #00ccff);
      font-family: Arial;
      text-align: center;
      padding-top: 100px;
    }

    .box{
      background: white;
      padding: 30px;
      width: 350px;
      margin: auto;
      border-radius: 15px;
      box-shadow: 0 0 20px rgba(0,0,0,0.2);
    }

    input{
      width: 90%;
      padding: 10px;
      margin: 8px;
      border-radius: 8px;
      border: 1px solid #ccc;
    }

    button{
      padding: 10px 20px;
      margin: 10px;
      border: none;
      border-radius: 8px;
      background: #00ccff;
      color: white;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover{
      background: #0099cc;
    }
  </style>
</head>
<body>

<div class="box">
  <h2>Login Nexus Studios</h2>

  <input type="text" id="nome" placeholder="Seu nome"><br>
  <input type="email" id="email" placeholder="E-mail"><br>
  <input type="password" id="senha" placeholder="Senha"><br>

  <button onclick="criarConta()">Criar Conta</button>
  <button onclick="login()">Entrar</button>

  <p id="msg"></p>
</div>

<script>

const firebaseConfig = {
  apiKey: "COLE_AQUI",
  authDomain: "COLE_AQUI",
  projectId: "COLE_AQUI",
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

function gerarID(nome){
  const ano = new Date().getFullYear();
  const hora = new Date().getHours();
  const minuto = new Date().getMinutes();
  return nome.substring(0,2).toUpperCase() + ano + hora + minuto;
}

function criarConta(){
  const nome = document.getElementById("nome").value;
  const email = document.getElementById("email").value;
  const senha = document.getElementById("senha").value;

  auth.createUserWithEmailAndPassword(email, senha)
  .then((userCredential) => {

    const user = userCredential.user;
    const idPersonalizado = gerarID(nome);

    db.collection("usuarios").doc(user.uid).set({
      nome: nome,
      email: email,
      idPersonalizado: idPersonalizado,
      dataCriacao: new Date(),
      statusPagamento: "aguardando_verificacao"
    });

    document.getElementById("msg").innerText = 
      "Conta criada! Seu ID Ã©: " + idPersonalizado;

  })
  .catch((error) => {
    document.getElementById("msg").innerText = error.message;
  });
}

function login(){
  const email = document.getElementById("email").value;
  const senha = document.getElementById("senha").value;

  auth.signInWithEmailAndPassword(email, senha)
  .then(() => {
    window.location.href = "https://site.google.com/view/nexusstudios/torneio-liberado";
  })
  .catch((error) => {
    document.getElementById("msg").innerText = error.message;
  });
}

</script>

</body>
</html>
